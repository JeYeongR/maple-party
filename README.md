# Maple Party Discord Bot

함께 메이플스토리를 즐길 때 유용한 정보를 조회하는 디스코드 봇입니다.

## ✨ 주요 기능

- **캐릭터 정보 조회**: 넥슨 API를 통해 메이플스토리 캐릭터의 상세 정보를 조회합니다.
- **음성 채널 기반 랭킹**: 현재 음성 채널에 참여한 유저들의 레벨, 전투력 랭킹을 확인합니다.
- **보스 클리어 관리**: 구글 시트와 연동하여 주차별 보스 클리어 현황을 확인하고 관리합니다.
- **사용자 등록**: 봇의 다양한 기능(랭킹, 보스 관리 등)에 사용할 캐릭터를 등록합니다.

## 💬 명령어

- `/검색 [캐릭터_이름]`: 넥슨 API를 통해 캐릭터 정보를 조회합니다.
- `/등록 [아이디]`: 랭킹 및 보스 클리어 현황에 사용할 캐릭터를 등록합니다.
- `/랭킹 [기준]`: 음성 채널에 참여한 유저들의 랭킹을 조회합니다. (기준: 전투력, 레벨)
- `/해방 [주차]`: 주차별 보스 클리어 체크리스트를 확인합니다.
- `/클리어 [주차]`: 등록된 모든 캐릭터의 주차별 보스 클리어 현황을 확인합니다.
- `/구글시트`: 보스 클리어 현황을 관리하는 구글 시트 링크를 확인합니다.

## 💻 기술 스택

- **주요 스택**: Node.js, discord.js
- **사용 API**: Nexon Open API, Google Sheets API

## ⚠️ 주의사항

본 봇은 친구들끼리 간단하게 사용하는 것을 목적으로 제작되었습니다.

- **데이터 관리**: 사용자 정보는 별도의 데이터베이스 없이 `db.json` 파일을 사용하여 관리됩니다. 따라서 봇을 재시작하거나 서버를 이전할 경우 이 파일의 백업이 필요합니다.
- **API 키**: 넥슨 API와 구글 시트 API를 사용하므로, 관련 API 키가 유출되지 않도록 `.env` 파일 관리에 주의해야 합니다.
- **구글 시트 구조**: 보스 관련 기능은 특정 구글 시트 구조에 맞춰져 있습니다. 만약 다른 구조의 시트를 사용하려면 `utils/google-sheets-util.js` 파일의 코드 수정이 필요할 수 있습니다.

## 🔧 설치 및 설정

1. **저장소 복제**

   ```bash
   git clone https://github.com/JeYeongR/maple-party.git
   cd maple-party
   ```

2. **의존성 설치**

   ```bash
   npm install
   ```

3. **Google Cloud Platform 설정**
   보스 관련 기능(`/해방`, `/클리어`)을 사용하려면 Google Sheets API 설정이 필요합니다. [공식 문서](https://cloud.google.com/sheets/api/quickstart/nodejs)를 참고하여 API를 활성화하고, 서비스 계정 키(`credentials.json`)를 발급받아 프로젝트 루트에 추가해주세요. 해당 서비스 계정에는 대상 구글 시트의 편집 권한이 필요합니다.

4. **환경 변수 설정**
   `.env.sample` 파일을 복사하여 `.env` 파일을 생성하고, 아래와 같이 환경 변수를 설정합니다.

   ```env
   # Discord Bot
   DISCORD_TOKEN=디스코드 봇 토큰
   CLIENT_ID=디스코드 봇 클라이언트 ID

   # Nexon API
   NEXON_API_KEY=넥슨 개발자 센터에서 발급받은 API 키

   # Google Sheets API
   SPREADSHEET_ID=보스 클리어 현황을 기록할 구글 시트의 ID

   # Server
   PORT=봇 상태 확인용 웹 서버 포트 (기본값: 3000)
   ```

## 🚀 사용법

1. **슬래시 커맨드 등록**

   ```bash
   node deploy-commands.js
   ```

2. **봇 실행**
   ```bash
   node index.js
   ```
